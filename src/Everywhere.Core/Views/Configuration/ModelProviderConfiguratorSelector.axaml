<ResourceDictionary
  xmlns="https://github.com/avaloniaui" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:v="using:Everywhere.Views">
  <ControlTheme
    x:Key="{x:Type v:ModelProviderConfiguratorSelector}"
    TargetType="v:ModelProviderConfiguratorSelector">
    <Setter Property="Template">
      <ControlTemplate>
        <StackPanel Spacing="8">
          <ListBox
            Width="{Binding $parent[DockPanel].Bounds.Width}"
            ItemsSource="{Binding ConfiguratorModels, RelativeSource={RelativeSource TemplatedParent}}"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollBarVisibility="Disabled"
            SelectedValue="{TemplateBinding SelectedType, Mode=TwoWay}"
            SelectedValueBinding="{Binding Type, DataType=v:ModelProviderConfiguratorSelector+ConfiguratorModel}">
            <ListBox.ItemsPanel>
              <ItemsPanelTemplate>
                <UniformGrid
                  ColumnSpacing="4" Rows="1"/>
              </ItemsPanelTemplate>
            </ListBox.ItemsPanel>

            <ListBox.ItemContainerTheme>
              <ControlTheme TargetType="ListBoxItem">
                <Setter Property="Background" Value="{DynamicResource CardBackgroundColor}"/>
                <Setter Property="FontSize" Value="{DynamicResource FontSizeM}"/>
                <Setter Property="FontWeight" Value="Medium"/>
                <Setter Property="Foreground" Value="{DynamicResource ForegroundColor}"/>
                <Setter Property="Focusable" Value="False"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="HorizontalContentAlignment" Value="Left"/>
                <Setter Property="CornerRadius" Value="{DynamicResource MdCornerRadius}"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Padding" Value="10,8"/>
                <Setter Property="Template">
                  <ControlTemplate>
                    <Panel>
                      <Border
                        x:Name="SelectedBorder"
                        Background="{DynamicResource SelectionColor}"
                        BoxShadow="{DynamicResource Shadow}"
                        CornerRadius="{TemplateBinding CornerRadius}"
                        Opacity="0">
                        <Border.Transitions>
                          <Transitions>
                            <DoubleTransition
                              Property="Opacity" Duration="0:0:0.20"/>
                          </Transitions>
                        </Border.Transitions>
                      </Border>
                      <Border
                        ClipToBounds="True"
                        CornerRadius="{TemplateBinding CornerRadius}">
                        <ContentPresenter
                          x:Name="ContentPresenter"
                          Padding="{TemplateBinding Padding}"
                          HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                          VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          Content="{TemplateBinding Content}"
                          ContentTemplate="{TemplateBinding ContentTemplate}"
                          Foreground="{TemplateBinding Foreground}"
                          Opacity="{TemplateBinding Opacity}"
                          RecognizesAccessKey="True">
                          <ContentPresenter.Transitions>
                            <Transitions>
                              <DoubleTransition
                                Property="Opacity" Duration="0:0:0.20"/>
                            </Transitions>
                          </ContentPresenter.Transitions>
                        </ContentPresenter>
                      </Border>
                    </Panel>
                  </ControlTemplate>
                </Setter>
                <Style Selector="^:disabled /template/ ContentPresenter#ContentPresenter">
                  <Setter Property="Opacity" Value="0.50"/>
                </Style>
                <Style Selector="^[IsSelected=False]">
                  <Style Selector="^ /template/ ContentPresenter#ContentPresenter">
                    <Setter Property="Opacity" Value="0.75"/>
                  </Style>
                  <Style Selector="^ /template/ Border#SelectedBorder">
                    <Setter Property="Opacity" Value="0"/>
                  </Style>
                </Style>
                <Style Selector="^:selected">
                  <Setter Property="Foreground" Value="{DynamicResource PrimaryColor}"/>
                  <Style Selector="^ /template/ Border#SelectedBorder">
                    <Setter Property="Opacity" Value="1"/>
                  </Style>
                  <Style Selector="^ /template/ ContentPresenter#ContentPresenter">
                    <Setter Property="Opacity" Value="1"/>
                  </Style>
                </Style>
              </ControlTheme>
            </ListBox.ItemContainerTheme>

            <ListBox.ItemTemplate>
              <DataTemplate DataType="v:ModelProviderConfiguratorSelector+ConfiguratorModel">
                <Border Background="{Binding Background}">
                  <StackPanel
                    Orientation="Vertical" Spacing="4">
                    <TextBlock
                      Classes="Large"
                      Text="{Binding HeaderKey^}"
                      TextWrapping="Wrap"/>
                    <TextBlock
                      Classes="Muted Small"
                      Text="{Binding DescriptionKey^}"
                      TextWrapping="Wrap"/>
                  </StackPanel>
                </Border>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>

          <v:SettingsItemsControl ItemsSource="{TemplateBinding SettingsItems}"/>
        </StackPanel>
      </ControlTemplate>
    </Setter>
  </ControlTheme>
</ResourceDictionary>
